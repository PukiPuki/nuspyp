"use strict";define("composer/categoryList",function(){var e={};e.init=function(e,r){var n=e.find(".category-list");if(!n.length){return}socket.emit("categories.getCategoriesByPrivilege","topics:create",function(e,t){if(e){return app.alertError(e.message)}t=t.filter(function(e){return!e.link});var o={};t.forEach(function(e){e.children=[];o[e.cid]=e});t.forEach(function(e){if(e.parent){var t=e.parent.cid;if(!o[t]){o[t]=e.parent;o[t].noPrivilege=true}o[t].children=o[t].children||[];o[t].children.push(e)}});t.length=0;Object.keys(o).forEach(function(e){if(!o[e].parent){t.push(o[e])}});t=t.sort(function(e,t){return e.order-t.order});var a=$('<option value="0"></option>');a.translateText("[[modules:composer.select_category]]").appendTo(n);t.forEach(function(e){i(e,n,"")});if(r.cid){n.find('option[value="'+r.cid+'"]').prop("selected",true)}else if(r.hasOwnProperty("cid")){r.cid=n.val()}$(".category-name").translateText(n.find('option[value="'+r.cid+'"]').text()||"[[modules:composer.select_category]]");$(".category-selector").find('li[data-cid="'+r.cid+'"]').addClass("active")});n.on("change",function(){if(r.hasOwnProperty("cid")){t(e,r,$(this).val())}$("[tabindex="+(parseInt($(this).attr("tabindex"),10)+1)+"]").trigger("focus")});$(".category-selector").on("click","li",function(){$(".category-name").text($(this).text());$(".category-selector").removeClass("open");$(".category-selector li").removeClass("active");$(this).addClass("active");var i=$(this).attr("data-cid");$(".category-list").val(i);if(r.hasOwnProperty("cid")){t(e,r,i)}})};function t(e,t,i){t.cid=i;require(["composer/tags"],function(t){t.updateWhitelist(e,i)})}function i(e,t,r){if(e.link){return}var n=r?"&bull; ":"";$('<option value="'+e.cid+'" '+(e.noPrivilege?"disabled":"")+">"+r+n+e.name+"</option>").appendTo(t);$('<li data-cid="'+e.cid+'">'+e.name+"</li>").appendTo($(".category-selector"));e.children.sort(function(e,t){return e.order-t.order}).forEach(function(e){i(e,t,"&nbsp;&nbsp;&nbsp;&nbsp;"+r)})}return e});
//# sourceMappingURL=node_modules/nodebb-plugin-composer-default/static/lib/composer/categoryList.js.map