{"version":3,"sources":["public/src/client/notifications.js"],"names":["define","components","notifs","Notifications","init","listEl","$","on","nid","this","parents","attr","socket","emit","err","app","alertError","count","message","updateNotifCount","timeago","get","removeClass"],"mappings":"AAAA,aAGAA,OAAO,uBAAwB,aAAc,iBAAkB,SAAUC,EAAYC,GACpF,IAAIC,KAEJA,EAAcC,KAAO,WACpB,IAAIC,EAASC,EAAE,uBACfD,EAAOE,GAAG,QAAS,wCAAyC,WAC3D,IAAIC,EAAMF,EAAEG,MAAMC,QAAQ,cAAcC,KAAK,YAC7CC,OAAOC,KAAK,yBAA0BL,EAAK,SAAUM,GACpD,GAAIA,EAAK,CACR,OAAOC,IAAIC,WAAWF,GAGvBF,OAAOC,KAAK,yBAA0B,SAAUC,EAAKG,GACpD,GAAIH,EAAK,CACR,OAAOC,IAAIC,WAAWF,EAAII,SAG3BhB,EAAOiB,iBAAiBF,SAK3BX,EAAE,YAAYc,UAEdnB,EAAWoB,IAAI,0BAA0Bd,GAAG,QAAS,WACpDK,OAAOC,KAAK,4BAA6B,SAAUC,GAClD,GAAIA,EAAK,CACR,OAAOC,IAAIC,WAAWF,EAAII,SAG3BjB,EAAWoB,IAAI,sBAAsBC,YAAY,UACjDpB,EAAOiB,iBAAiB,QAK3B,OAAOhB","file":"public/src/client/notifications.js","sourcesContent":["'use strict';\n\n\ndefine('forum/notifications', ['components', 'notifications'], function (components, notifs) {\n\tvar Notifications = {};\n\n\tNotifications.init = function () {\n\t\tvar listEl = $('.notifications-list');\n\t\tlistEl.on('click', '[component=\"notifications/item/link\"]', function () {\n\t\t\tvar nid = $(this).parents('[data-nid]').attr('data-nid');\n\t\t\tsocket.emit('notifications.markRead', nid, function (err) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn app.alertError(err);\n\t\t\t\t}\n\n\t\t\t\tsocket.emit('notifications.getCount', function (err, count) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t\t}\n\n\t\t\t\t\tnotifs.updateNotifCount(count);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\t$('.timeago').timeago();\n\n\t\tcomponents.get('notifications/mark_all').on('click', function () {\n\t\t\tsocket.emit('notifications.markAllRead', function (err) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t}\n\n\t\t\t\tcomponents.get('notifications/item').removeClass('unread');\n\t\t\t\tnotifs.updateNotifCount(0);\n\t\t\t});\n\t\t});\n\t};\n\n\treturn Notifications;\n});\n"]}